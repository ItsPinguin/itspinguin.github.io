<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Gravity Sim</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

    <style>
        body { margin: 0; background-color: black; overflow: hidden; }
        canvas { width: 100%; height: 100%; }
    </style>
</head>
<body class="bg-black m-0 overflow-hidden font-sans">    <canvas id="glcanvas"></canvas>
    <script src="https://not-fl3.github.io/miniquad-samples/mq_js_bundle.js"></script>
    <script>
        miniquad_add_plugin({
            register_plugin: function (importObject) {
                // This 'env' object is where Rust's extern "C" looks
                importObject.env.get_gravity_value = function () {
                    const val = parseFloat(document.getElementById("gravityRange").value);
                    return isNaN(val) ? 0.0 : val;
                };
                importObject.env.get_spawning_mass = function () {
                    const val = parseFloat(document.getElementById("mRange").value);
                    return isNaN(val) ? 0.0 : val;
                };
                // importObject.env.get_gravity_sign = function () {
                //     const val = (document.getElementById("gSignBox").checked);
                //     return isNaN(val) ? 1.0 : val ? 1.0 : -1.0;
                // };
            }
        });
        
        load("/assets/data/projects/rusty_gravity/rusty-gravity.wasm");
    </script>

    <div class="absolute top-5 left-5 z-10 bg-gray-900/80 p-6 rounded-xl border border-gray-700 text-white w-64 backdrop-blur-md">
        <h2 class="text-xl font-bold mb-4 border-b border-gray-700 pb-2">Gravity Controls</h2>
        <details class="mb-2 cursor-pointer" open>
            <summary>Initial Conditions</summary>

            <div class="mb-2 flex flex-row gap-4 justify-between w-full">
                <label id="gLabel" class="block text-sm mb-1">Gravity Strength</label>
                <input type="number" id="gravityRange" min="-10000" max="10000" value="0" class="accent-blue-500 text-sm bg-blue-900/50 rounded-sm px-1 w-16">
            </div>
        </details>

        <details class="mb-2 cursor-pointer" open>
            <summary>New bodies</summary>
            
            <!-- <div class="flex flex-row justify-start align-center gap-2">
                
                <input type="checkbox" id="gSignBox" class="accent-blue-500" name="gSignBox" checked>
                <label for="gSignBox" id="gSignLabel" class="block text-sm mb-1">Inverse gravity</label>
                <script>
                    const checked = document.getElementById('gSignBox');
                    checked.addEventListener('input', (e) => {
                        console.log(checked.checked)
                    })
                </script>
            </div> -->

            <div class="mb-2 flex flex-row gap-4 justify-between w-full">
                <label id="mRangeLabel" class="block text-sm mb-1">Mass</label>
                <input type="number" id="mRange" min="-1000" max="1000" value="10" class="accent-blue-500 text-sm bg-blue-900/50 rounded-sm px-1 w-16">
            </div>
        </details>

        

        

        <button onclick="location.reload()" class="mt-2 w-full bg-blue-600 hover:bg-blue-500 py-2 rounded-lg transition font-semibold">
            Reset Simulation
        </button>

        <div class="mt-6 text-xs text-gray-400">
            <p>Built with <span class="text-orange-400">Rust</span> + <span class="text-blue-400">Wasm</span></p>
        </div>
    </div>
</body>
</html>